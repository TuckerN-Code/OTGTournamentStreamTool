<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="InGameOverlay.css" />
</head>

<body class="body">
    <table class="scoreboard">
        <tr>
            <td>
            <svg height="66" width="500">
                <polygon id="P1Poly" points="500,0 500,0 500,66 500,66" display="inline"/>
                <text x="55%" y="50%" dominant-baseline="middle" class="PlayerNameText" ><tspan class="PlayerPrefixText" id="P1Prefix">APPLE</tspan><tspan id="P1Tag">JeJaJeJa</tspan></text>
            </svg>
            </td>
            <td>
                <svg height="66" width="80">
                    <polygon id="ScorePoly" points="0,0 80,0 80,66 0,66" display="inline" fill="white" />

                    <text x="5%" y="50" dominant-baseline="middle" class="ScoreText"><tspan id="P1Score">1</tspan><tspan>:</tspan><tspan id="P2Score">2</tspan></text>
                </svg>
            </td>
            <td>
                <svg height="66" width="500">
                    <polygon id="P2Poly" points="0,0 0,0 0,66 0,66" display="inline" />
                    <text x="45%" y="50%" dominant-baseline="middle" class="PlayerNameText"><tspan class="PlayerPrefixText" id="P2Prefix">APPLE</tspan><tspan id="P2Tag">JeJaJeJa</tspan></text>
                </svg></td>
        </tr>
    </table>
    <table class="Infoboard">
        <tr>
            <td class="TourInfoText" id="TourRound">Winners QuarterFinals</td>
            <td class="TourInfoText" id="TourRound">Winners QuarterFinals</td>
            <td class="TourInfoText" id="TourRound">Winners QuarterFinals</td>
        </tr>
    </table>
</body>

</html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha512-z4OUqw38qNLpn1libAN9BsoDx6nbNFio5lA6CuTp9NlK83b89hgyCVq+N5FdBJptINztxn1Z3SaKSKUS5UP60Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    var DataRefreshAni = anime({
        targets: ['.PlayerNameText'],
        opacity: ['0%', '100%'],
        duration: 500,
        easing: 'easeInOutQuad',
        autoplay: false
    });
</script>

<script>
    var svgP1PolygonTransformation = anime({
        targets: '#P1Poly',
        points: '0,0 500,0 500,66 66,66',
        duration: 500,
        easing: 'linear',
        autoplay: false,

    })
    var svgP2PolygonTransformation = anime({
        targets: '#P2Poly',
        points: '0,0 500,0 440,66 0,66',
        duration: 750,
        easing: 'linear',
        autoplay: false
    })

    function startUpAnis() {
        svgP1PolygonTransformation.play();
        svgP2PolygonTransformation.play();
        svgP2PolygonTransformation.finished.then(() => { DataRefreshAni.play() })
    }
    document.onload = startUpAnis();

</script>

<script>
    var localID = 0;
    var prevID = -1;
    const userAction = async () => {
        const response = await fetch('http://localhost:5549/players');
        const myPlayer = await response.json();
        var refreshPlayers = false;
        localID = myPlayer["packageID"];
        if (localID != prevID) {
            if (document.getElementById("P1Tag").innerHTML != myPlayer["player1Tag"] ||
                document.getElementById("P1Prefix").innerHTML != myPlayer["player1Prefix"] ||
                document.getElementById("P2Tag").innerHTML != myPlayer["player2Tag"] ||
                document.getElementById("P2Prefix").innerHTML != myPlayer["player2Prefix"])
            {
                refreshPlayers = true;
            }
            document.getElementById("P1Tag").innerHTML = myPlayer["player1Tag"];
            document.getElementById("P1Prefix").innerHTML = myPlayer["player1Prefix"];
            //document.getElementById("Player1Twitter").innerHTML = myPlayer["player1Twitter"];
            //document.getElementById("Player1Pronouns").innerHTML = myPlayer["player1Pronouns"];
            document.getElementById("P2Tag").innerHTML = myPlayer["player2Tag"];
            document.getElementById("P2Prefix").innerHTML = myPlayer["player2Prefix"];
            //document.getElementById("Player2Twitter").innerHTML = myPlayer["player2Twitter"];
            //document.getElementById("Player2Pronouns").innerHTML = myPlayer["player2Pronouns"];
            document.getElementById("TourRound").innerHTML = myPlayer["tournamentRound"];
            document.getElementById("P1Score").innerHTML = myPlayer["player1Score"];
            document.getElementById("P2Score").innerHTML = myPlayer["player2Score"];
            document.getElementById("TourName").innerHTML = myPlayer["tournamentName"];
            document.getElementById("TourEvent").innerHTML = myPlayer["tournamnetEvent"];
            prevID = localID;
            if (refreshPlayers)
                DataRefreshAni.restart;
        }
    }
    window.setInterval(userAction, 100);


</script>